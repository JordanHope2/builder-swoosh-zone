name: Secret Scan
on:
  push:
  pull_request:

permissions:
  contents: read
  pull-requests: read         # needed on PRs
  # security-events: write    # uncomment if you upload SARIF below

jobs:
  gitleaks:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0       # scan full history (or set to 1 for just the commit)

      - name: Run Gitleaks
        uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}   # <-- REQUIRED
        # with:
        #   report-format: sarif
        #   report-path: gitleaks.sarif
        #   redact: true

      # If you enabled SARIF above, upload it to GitHub Code Scanning:
      # - name: Upload SARIF to code scanning
      #   if: always()
      #   uses: github/codeql-action/upload-sarif@v3
      #   with:
      #     sarif_file: gitleaks.sarif
